# =============================================================================
# MBPO-Breakout Debug Configuration
# =============================================================================
# Quick testing configuration with reduced parameters
# =============================================================================

# Random seed
seed: 42

# Environment Configuration
env:
  name: "BreakoutNoFrameskip-v4"
  num_envs: 2 # Fewer parallel envs for debugging
  frame_stack: 4
  frame_size: 84
  noop_max: 30
  frame_skip: 4
  record_video: true
  video_trigger_freq: 10 # Record more frequently
  video_dir: "videos"

# Debug settings
debug:
  action_debug_steps: 5000
  action_log_freq: 1000

# Training Configuration (reduced for quick testing)
training:
  total_timesteps: 50_000 # Short test run
  buffer_size: 10_000 # Smaller buffer
  batch_size: 64 # Smaller batch for speed
  learning_starts: 2_000 # Start training quickly
  gamma: 0.99
  tau: 0.005
  grad_norm_skip_threshold: 10.0

  # Learning rates
  policy_lr: 1e-4  # Reduced to prevent gradient explosion
  dynamics_lr: 1e-3

  # MBPO specific
  model_rollout_freq: 100 # More frequent for testing
  model_rollout_length: 1
  model_rollout_batch_size: 100 # Smaller for speed
  real_ratio: 0.05

  # Update frequencies
  train_freq: 4
  gradient_steps: 1
  target_update_freq: 5_000

# Model Configuration
model:
  cnn_channels: [ 32, 64, 64 ]
  cnn_kernels: [ 8, 4, 3 ]
  cnn_strides: [ 4, 2, 1 ]
  fc_dim: 256 # Smaller for debugging

  # Dynamics Ensemble
  ensemble_size: 3 # Fewer models for debugging
  dynamics_hidden_dim: 128 # Smaller for speed
  predict_reward: true

# Early Stopping
early_stopping:
  enabled: false # Disabled for debug to see full behavior
  target_reward: 50.0
  window_size: 10
  patience: 1000 # Very high patience if accidentally enabled

# Logging & Checkpoints
logging:
  log_freq: 500 # More frequent logging
  save_freq: 10_000 # More frequent saves
  checkpoint_dir: "checkpoints"

# Wandb Configuration
wandb:
  enabled: false # Disable for quick local testing
  project: "MBPO-Breakout-Debug"
  entity: null
  tags: [ "mbpo", "breakout", "debug" ]

# Algorithm Selection
algorithm: "mbpo"

# Algorithm-specific configs
ppo:
  clip_range: 0.2
  ent_coef: 0.1  # Increased to prevent entropy collapse
  vf_coef: 0.5
  max_grad_norm: 0.5
  n_epochs: 4
  gae_lambda: 0.95

sac:
  ent_coef: "auto"
  target_entropy: "auto"
  init_temperature: 0.2

ddqn:
  epsilon_start: 1.0
  epsilon_end: 0.01
  epsilon_decay: 0.995
  epsilon_end: 0.01
  epsilon_decay: 0.995
  double_dqn: true

# Seed for reproducibility
seed: 42
