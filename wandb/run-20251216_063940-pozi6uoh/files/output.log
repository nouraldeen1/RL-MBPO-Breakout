wandb: Detected [agents] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/

Starting training for 100,000 timesteps...
============================================================
[ActionDebug] Step 0: {'action/0': 4, 'action/1': 0, 'action/2': 0, 'action/3': 0}
Step:      1,000 | Episodes:     21 | Mean Reward (100):    0.48 | Best:    -inf
[ActionDebug] Step 1000: {'action/0': 253, 'action/1': 244, 'action/2': 251, 'action/3': 256}
Step:      2,000 | Episodes:     48 | Mean Reward (100):    0.40 | Best:    -inf
[ActionDebug] Step 2000: {'action/0': 509, 'action/1': 496, 'action/2': 512, 'action/3': 487}
Step:      3,000 | Episodes:     74 | Mean Reward (100):    0.38 | Best:    -inf
[ActionDebug] Step 3000: {'action/0': 748, 'action/1': 760, 'action/2': 778, 'action/3': 718}
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000100 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000100.mp4 (reward: 2.0)
Step:      4,000 | Episodes:    104 | Mean Reward (100):    0.35 | Best:    0.35
[ActionDebug] Step 4000: {'action/0': 987, 'action/1': 1004, 'action/2': 1031, 'action/3': 982}
Step:      5,000 | Episodes:    138 | Mean Reward (100):    0.23 | Best:    0.36
[ActionDebug] Step 5000: {'action/0': 1240, 'action/1': 1244, 'action/2': 1305, 'action/3': 1215}
Step:      6,000 | Episodes:    166 | Mean Reward (100):    0.25 | Best:    0.36
[ActionDebug] Step 6000: {'action/0': 1470, 'action/1': 1506, 'action/2': 1579, 'action/3': 1449}
Step:      7,000 | Episodes:    185 | Mean Reward (100):    0.26 | Best:    0.36
[ActionDebug] Step 7000: {'action/0': 1747, 'action/1': 1750, 'action/2': 1820, 'action/3': 1687}
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000201 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000201.mp4 (reward: 0.0)
Step:      8,000 | Episodes:    217 | Mean Reward (100):    0.30 | Best:    0.36
[ActionDebug] Step 8000: {'action/0': 1989, 'action/1': 2005, 'action/2': 2053, 'action/3': 1957}
Step:      9,000 | Episodes:    243 | Mean Reward (100):    0.33 | Best:    0.36
[ActionDebug] Step 9000: {'action/0': 2225, 'action/1': 2251, 'action/2': 2306, 'action/3': 2222}
Step:     10,000 | Episodes:    274 | Mean Reward (100):    0.26 | Best:    0.36
Step:     11,000 | Episodes:    299 | Mean Reward (100):    0.28 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000300 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000300.mp4 (reward: 0.0)
Step:     12,000 | Episodes:    325 | Mean Reward (100):    0.34 | Best:    0.36
Step:     13,000 | Episodes:    360 | Mean Reward (100):    0.27 | Best:    0.36
Step:     14,000 | Episodes:    384 | Mean Reward (100):    0.32 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000400 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000400.mp4 (reward: 0.0)
Step:     15,000 | Episodes:    412 | Mean Reward (100):    0.25 | Best:    0.36
Step:     16,000 | Episodes:    439 | Mean Reward (100):    0.28 | Best:    0.36
Step:     17,000 | Episodes:    472 | Mean Reward (100):    0.26 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000500 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000500.mp4 (reward: 0.0)
Step:     18,000 | Episodes:    507 | Mean Reward (100):    0.20 | Best:    0.36
Step:     19,000 | Episodes:    542 | Mean Reward (100):    0.13 | Best:    0.36
Step:     20,000 | Episodes:    563 | Mean Reward (100):    0.23 | Best:    0.36
Step:     21,000 | Episodes:    590 | Mean Reward (100):    0.27 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000600 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000600.mp4 (reward: 0.0)
Step:     22,000 | Episodes:    621 | Mean Reward (100):    0.29 | Best:    0.36
Step:     23,000 | Episodes:    647 | Mean Reward (100):    0.33 | Best:    0.36
Step:     24,000 | Episodes:    679 | Mean Reward (100):    0.26 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000702 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000702.mp4 (reward: 0.0)
Step:     25,000 | Episodes:    711 | Mean Reward (100):    0.26 | Best:    0.36
Step:     26,000 | Episodes:    740 | Mean Reward (100):    0.27 | Best:    0.36
Step:     27,000 | Episodes:    772 | Mean Reward (100):    0.24 | Best:    0.36
Step:     28,000 | Episodes:    799 | Mean Reward (100):    0.23 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000800 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000800.mp4 (reward: 0.0)
Step:     29,000 | Episodes:    826 | Mean Reward (100):    0.28 | Best:    0.36
Step:     30,000 | Episodes:    853 | Mean Reward (100):    0.30 | Best:    0.36
Step:     31,000 | Episodes:    880 | Mean Reward (100):    0.35 | Best:    0.36
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-000900 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-000900.mp4 (reward: 0.0)
Step:     32,000 | Episodes:    912 | Mean Reward (100):    0.31 | Best:    0.38
Step:     33,000 | Episodes:    939 | Mean Reward (100):    0.26 | Best:    0.38
Step:     34,000 | Episodes:    968 | Mean Reward (100):    0.28 | Best:    0.38
Step:     35,000 | Episodes:    997 | Mean Reward (100):    0.26 | Best:    0.38
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-001000 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-001000.mp4 (reward: 0.0)
Step:     36,000 | Episodes:   1029 | Mean Reward (100):    0.28 | Best:    0.38
Step:     37,000 | Episodes:   1060 | Mean Reward (100):    0.21 | Best:    0.38
Step:     38,000 | Episodes:   1092 | Mean Reward (100):    0.21 | Best:    0.38
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-001100 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-001100.mp4 (reward: 0.0)
Step:     39,000 | Episodes:   1118 | Mean Reward (100):    0.28 | Best:    0.38
Step:     40,000 | Episodes:   1147 | Mean Reward (100):    0.27 | Best:    0.38
Step:     41,000 | Episodes:   1177 | Mean Reward (100):    0.30 | Best:    0.38
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-001200 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-001200.mp4 (reward: 0.0)
Step:     42,000 | Episodes:   1211 | Mean Reward (100):    0.25 | Best:    0.38
Step:     43,000 | Episodes:   1248 | Mean Reward (100):    0.19 | Best:    0.38
Step:     44,000 | Episodes:   1275 | Mean Reward (100):    0.18 | Best:    0.38
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-001300 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-001300.mp4 (reward: 0.0)
Step:     45,000 | Episodes:   1306 | Mean Reward (100):    0.20 | Best:    0.38
Step:     46,000 | Episodes:   1335 | Mean Reward (100):    0.22 | Best:    0.38
Step:     47,000 | Episodes:   1364 | Mean Reward (100):    0.25 | Best:    0.38
Step:     48,000 | Episodes:   1388 | Mean Reward (100):    0.31 | Best:    0.38
C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\gymnasium\wrappers\rendering.py:283: UserWarning: [33mWARN: Overwriting existing videos at D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\videos\eval-001400 folder (try specifying a different `video_folder` for the `RecordVideo` wrapper if this is not desired)[0m
  logger.warn(
[Video] Saved episode video: videos\eval-episode-001400.mp4 (reward: 0.0)
Step:     49,000 | Episodes:   1417 | Mean Reward (100):    0.31 | Best:    0.38
[Training] Step 50000: policy_loss=-0.0003, grad_norm=0.5000, entropy=1.3863
Step:     50,000 | Episodes:   1441 | Mean Reward (100):    0.34 | Best:    0.38
[Training] Step 50100: policy_loss=0.0320, grad_norm=0.5000, entropy=0.9379
Traceback (most recent call last):
  File ".\src\main.py", line 509, in <module>
    main()
  File ".\src\main.py", line 505, in main
    train(config, args)
  File ".\src\main.py", line 363, in train
    update_metrics = agent.update()
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 342, in update
    n_generated = self.generate_model_rollouts()
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 237, in generate_model_rollouts
    next_states, rewards, uncertainty = self.dynamics.predict_next_state(
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py", line 624, in predict_next_state
    delta, reward = self.models[idx](state[i:i+1], action[i:i+1])
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py", line 459, in forward
    delta_state = self.delta_decoder(transition_features)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\container.py", line 219, in forward
    input = module(input)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\conv.py", line 948, in forward
    return F.conv_transpose2d(
KeyboardInterrupt
Traceback (most recent call last):
  File ".\src\main.py", line 509, in <module>
    main()
  File ".\src\main.py", line 505, in main
    train(config, args)
  File ".\src\main.py", line 363, in train
    update_metrics = agent.update()
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 342, in update
    n_generated = self.generate_model_rollouts()
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 237, in generate_model_rollouts
    next_states, rewards, uncertainty = self.dynamics.predict_next_state(
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py", line 624, in predict_next_state
    delta, reward = self.models[idx](state[i:i+1], action[i:i+1])
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py", line 459, in forward
    delta_state = self.delta_decoder(transition_features)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\container.py", line 219, in forward
    input = module(input)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\modules\conv.py", line 948, in forward
    return F.conv_transpose2d(
KeyboardInterrupt
