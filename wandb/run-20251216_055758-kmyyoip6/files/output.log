wandb: Detected [agents] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/

Starting training for 1,000,000 timesteps...
============================================================
[ActionDebug] Step 0: {'action/0': 4, 'action/1': 0, 'action/2': 0, 'action/3': 0}
D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py:691: UserWarning: Using a target size (torch.Size([256, 4, 84, 84])) that is different to the input size (torch.Size([256, 4, 74, 74])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  delta_loss = F.mse_loss(pred_delta, target_delta)
Traceback (most recent call last):
  File ".\src\main.py", line 509, in <module>
    main()
  File ".\src\main.py", line 505, in main
    train(config, args)
  File ".\src\main.py", line 363, in train
    update_metrics = agent.update()
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 338, in update
    dynamics_metrics = self.train_dynamics(n_updates=1)
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 190, in train_dynamics
    loss, metrics = self.dynamics.compute_loss(
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py", line 691, in compute_loss
    delta_loss = F.mse_loss(pred_delta, target_delta)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\functional.py", line 3383, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\functional.py", line 77, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (74) must match the size of tensor b (84) at non-singleton dimension 3
Traceback (most recent call last):
  File ".\src\main.py", line 509, in <module>
    main()
  File ".\src\main.py", line 505, in main
    train(config, args)
  File ".\src\main.py", line 363, in train
    update_metrics = agent.update()
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 338, in update
    dynamics_metrics = self.train_dynamics(n_updates=1)
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\agents.py", line 190, in train_dynamics
    loss, metrics = self.dynamics.compute_loss(
  File "D:\as3b folder\CCE-C\term 5\rl\RL-last\RL-MBPO-Breakout\src\models.py", line 691, in compute_loss
    delta_loss = F.mse_loss(pred_delta, target_delta)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\nn\functional.py", line 3383, in mse_loss
    expanded_input, expanded_target = torch.broadcast_tensors(input, target)
  File "C:\Users\nourh\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.8_qbz5n2kfra8p0\LocalCache\local-packages\Python38\site-packages\torch\functional.py", line 77, in broadcast_tensors
    return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
RuntimeError: The size of tensor a (74) must match the size of tensor b (84) at non-singleton dimension 3
